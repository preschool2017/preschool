var ngg_mosaic_methods={high_dpi:!1,init:function(){this.high_dpi=this.getDPIRatio()>1,_.each(document.getElementsByClassName("ngg-pro-mosaic-container"),function(t){var i=t.getAttribute("data-ngg-pro-mosaic-id"),e=ngg_mosaic_methods.get_gallery(i);if(ngg_mosaic_methods.get_setting(i,"lazy_load_enable",!1,"bool")){var n=ngg_mosaic_methods.get_setting(e.ID,"lazy_load_initial",35,"int");e.mosaic_loaded=[],_.each(e.images_list,function(i,o){o<n&&(e.mosaic_loaded.push(i.image_id),t.appendChild(ngg_mosaic_methods.create_image(e,i)))})}else _.each(e.images_list,function(i){t.appendChild(ngg_mosaic_methods.create_image(e,i))})})},getDPIRatio:function(){var t=1;return void 0!==window.screen.systemXDPI&&void 0!==window.screen.logicalXDPI&&window.screen.systemXDPI>window.screen.logicalXDPI?t=window.screen.systemXDPI/window.screen.logicalXDPI:void 0!==window.devicePixelRatio&&(t=window.devicePixelRatio),t},get_gallery:function(t){var i=null;return"undefined"==typeof window.galleries?i:_.find(galleries,function(i){return i.ID==t})},get_setting:function(t,i,e,n){n=n||"bool";var o=this.get_gallery(t);return o&&"undefined"!=typeof o.display_settings[i]&&(e=o.display_settings[i]),"bool"==n?(1!=e&&"1"!=e||(e=!0),0!=e&&"0"!=e||(e=!1)):"int"==n&&(e=parseInt(e)),e},create_image:function(t,i,e){var n=this,o=document.createElement("div");o.setAttribute("class","ngg-pro-mosaic-item");var s=document.createElement("img"),a=i.image;n.high_dpi&&i.use_hdpi&&(a=i.srcsets.hdpi),s.setAttribute("title",i.title),s.setAttribute("alt",i.title),s.setAttribute("src",a),s.setAttribute("width",i.width),s.setAttribute("height",i.height);var r=document.createElement("a"),g=t.mosaic_effect_code.match(/(\S+)=["']?((?:.(?!["']?\s+(?:\S+)=|[>"']))+.)["']?/gi);if(g)for(var l=0;l<g.length;l++){var c=g[l].match(/(\S+)=["']?((?:.(?!["']?\s+(?:\S+)=|[>"']))+.)["']?/i);r.setAttribute(c[1],c[2])}return r.setAttribute("href",i.full_image),r.setAttribute("title",i.description),r.setAttribute("data-image-id",i.image_id),r.setAttribute("data-src",i.image),r.setAttribute("data-thumbnail",i.thumb),r.setAttribute("data-title",i.title),r.setAttribute("data-description",i.description),r.setAttribute("data-ngg-captions-nostylecopy","1"),"undefined"!=typeof e&&r.setAttribute("onload",e),r.appendChild(s),o.appendChild(r),o}};ngg_mosaic_methods.init(),function(t){"use strict";var i={image_loaded:function(t){this.scroll_pending=_.without(this.scroll_pending,t)},scroll_action_running:null,scroll_timer:null,scroll_step:5,scroll_pending:[],scroll_more_to_find:!0,scroll_action:function(i,e){if(!(1==this.scroll_action_running||this.scroll_timer||!this.scroll_more_to_find||this.scroll_pending.length>=1)){this.scroll_action_running=!0;var n=this;this.scroll_timer=setTimeout(function(){clearTimeout(n.scroll_timer),n.scroll_timer=!1},500),setTimeout(function(){var o=t(e),s=t(window).height(),a=t(window).scrollTop(),r=s+a,g=o.height()+o.offset().top,l=o.find(".ngg-pro-mosaic-item.entry-visible").first().height(),c=o.find(".ngg-pro-mosaic-item.entry-visible").last().height();if(r<=g-c-2*l)return void(n.scroll_action_running=!1);var d=ngg_mosaic_methods.get_gallery(i),m=ngg_mosaic_methods.get_setting(i,"lazy_load_batch",this.scroll_step,"int");d.images_list.length-d.mosaic_loaded.length<m&&(m=d.images_list.length-d.mosaic_loaded.length,n.scroll_more_to_find=!1);for(var h=0;h<m;h++){var u=_.find(d.images_list,function(t){return _.indexOf(d.mosaic_loaded,t.image_id)==-1});d.mosaic_loaded.push(u.image_id),o.append(ngg_mosaic_methods.create_image(d,u,n.image_loaded(u.image_id)))}o.justifiedGallery("norewind"),n.scroll_action_running=!1,setTimeout(function(){n.scroll_action(i,e)},800)},60)}}};_.each(t(".ngg-pro-mosaic-container"),function(e){var n=t(e),o=n.data("ngg-pro-mosaic-id"),s={captions:!1,cssAnimation:!0,waitThumbnailsLoad:!1,justifyThreshold:.9,rowHeight:ngg_mosaic_methods.get_setting(o,"row_height",200,"int"),margins:ngg_mosaic_methods.get_setting(o,"margins",15,"int"),lastRow:ngg_mosaic_methods.get_setting(o,"last_row","justify","string")},a=ngg_mosaic_methods.get_gallery(o);n.css({"min-height":ngg_mosaic_methods.get_setting(o,"row_height",200,"int")+"px"}),ngg_mosaic_methods.get_setting(o,"lazy_load_enable",!1,"bool")&&t(window).scroll(function(){i.scroll_action(a.ID,e)}),n.on("jg.complete",function(){t(window).trigger("ngg.mosaic.complete",[n]),t(window).trigger("resize",[n]),n.waitForImages(function(){t(window).trigger("refreshed")})}),n.justifiedGallery(s)})}(jQuery);