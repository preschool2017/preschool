jQuery(function(e){e("#npl_content").on("npl.ready",function(a,t){var i=t.methods,n=t.galleria_theme;i.sidebars.cart={init:function(){},render:function(e){n.$("sidebar-overlay").addClass("npl-sidebar-overlay-open"),n.$("sidebar-container").empty();var a=new Ngg_Pro_Cart.Views.Add_To_Cart({image_id:e,container:n.$("sidebar-container")});a.on("rendered",this.show_licensing_terms),a.on("ready",function(){a.render(),n.trigger("npl.sidebar.rendered")})},show_licensing_terms:function(){var a={action:"get_digital_download_settings",image_id:this.image_id},t=this.$el.find("#ngg_digital_downloads_header");e.post(parent.photocrati_ajax.url,a,function(e){"object"!=typeof e&&(e=JSON.parse(e)),t.html(e.header),n.$("sidebar-overlay").removeClass("npl-sidebar-overlay-open")})},get_type:function(){return"cart"},events:{bind:function(){n.bind("npl.init",this.npl_init),n.bind("npl.init.keys",this.npl_init_keys),n.bind("image",this.image),n.bind("loadstart",this.loadstart)},loadstart:function(){e.nplModal("get_state").sidebar&&e.nplModal("get_state").sidebar==i.sidebars.cart.get_type()&&n.$("sidebar-overlay").addClass("npl-sidebar-overlay-open")},_image_ran_once:!1,image:function(){i.sidebars.cart.events.is_ecommerce_enabled()&&(i.sidebars.cart._image_ran_once?e.nplModal("get_state").sidebar&&e.nplModal("get_state").sidebar==i.sidebars.cart.get_type()&&i.sidebar.render(i.sidebars.cart.get_type()):(e.nplModal("get_state").sidebar&&e.nplModal("get_state").sidebar==i.sidebars.cart.get_type()||e.nplModal("get_setting","display_cart",!1)&&!e.nplModal("get_setting","display_comments",!1))&&!Galleria.TOUCH&&i.sidebar.open(i.sidebars.cart.get_type()),i.sidebars.cart._image_ran_once=!0)},is_ecommerce_enabled:function(){var a=!1,t=e.nplModal("get_gallery_from_id",e.nplModal("get_state").gallery_id);return t&&"undefined"!=typeof t.display_settings.is_ecommerce_enabled&&(a=t.display_settings.is_ecommerce_enabled),t&&"undefined"!=typeof t.display_settings.original_settings&&"undefined"!=typeof t.display_settings.original_settings.is_ecommerce_enabled&&(a=t.display_settings.original_settings.is_ecommerce_enabled),parseInt(a)},npl_init:function(){var a=i.sidebars.cart.events.is_ecommerce_enabled;if(a()){var t=e("<i/>").addClass("nggpl-toolbar-button-cart fa fa-shopping-cart").attr({title:ngg_cart_i18n.nggpl_toggle_sidebar}).click(function(e){i.sidebar.toggle(i.sidebars.cart.get_type()),e.preventDefault()});i.thumbnails.register_button(t)}},npl_init_keys:function(a){var t=i.galleria.get_keybinding_exclude_list();n.attachKeyboard({69:function(){var a=i.sidebars.cart.events.is_ecommerce_enabled;!e(document.activeElement).is(t)&&a()&&i.sidebar.toggle(i.sidebars.cart.get_type())}})}}},i.sidebars.cart.events.bind()}),e(document).on("ngg-caption-add-icons",function(a,t){if(e.nplModal("get_displayed_gallery_setting",t.gallery_id,"is_ecommerce_enabled",!1)){var i=e("<i/>",{class:"fa fa-shopping-cart nextgen_pro_lightbox ngg-caption-icon","data-nplmodal-gallery-id":t.gallery_id,"data-nplmodal-image-id":t.image_id,"data-image-id":t.image_id,"data-nplmodal-show-cart":"1"}).on("click",function(a){return a.preventDefault(),e.nplModal("open",e(this)),!1});t.el.append(i)}})});