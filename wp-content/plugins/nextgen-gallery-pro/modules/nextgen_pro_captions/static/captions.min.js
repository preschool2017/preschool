!function(t){if(!(t.browser.msie&&t.browser.version<=8)){var e=function(e){if("undefined"==typeof window.galleries)return null;var n=null;return t.each(window.galleries,function(t,a){a.ID==e&&(n=a)}),n},n=function(t,e,n){var a=n;return a="undefined"!=typeof t.display_settings[e]&&""!=t.display_settings[e]?t.display_settings[e]:n,1==a&&(a=!0),0==a&&(a=!1),"1"==a&&(a=!0),"0"==a&&(a=!1),"false"==a&&(a=!1),"true"==a&&(a=!0),a},a=["EM","STRONG","B","DEL","I","INS","MARK","SMALL","STRIKE","SUB","SUP","TT","U"],i=function(t){var e=document.createElement("div");return e.innerHTML=t,r(e),e.innerHTML},r=function(t){for(var e=Array.prototype.slice.apply(t.getElementsByTagName("*"),[0]),n=0;n<e.length;n++)a.indexOf(e[n].nodeName)==-1&&o(e[n])},o=function(t){for(var e=t,n=t.childNodes.length-1;n>=0;n--){var a=t.removeChild(t.childNodes[n]);t.parentNode.insertBefore(a,e),e=a}t.parentNode.removeChild(t)};nggc_share_icons={strip_html:function(t){var e=document.createElement("div");return e.innerHTML=t,e.textContent||e.innerText||""},create:function(e,n){var a=n.data("image-id"),i=n.data("nplmodal-gallery-id"),r=encodeURIComponent(this.get_share_url(i,a)),o=encodeURIComponent(window.location.toString()),s=this.strip_html(n.data("title")),d=this.strip_html(n.data("description")),g=t("<i/>",{"data-href":"https://twitter.com/share?url="+this.get_share_url(i,a,"full"),class:"ngg-caption-icon fa fa-twitter-square"}),c=t("<i/>",{"data-href":"https://plus.google.com/share?url="+r,class:"ngg-caption-icon fa fa-google-plus-square"}),l="&p[url]="+encodeURIComponent(this.get_share_url(i,a,"full"));s.length>0&&(l+="&p[title]="+s.trim()),d.length>0&&(l+="&p[summary]="+d.trim()),l+="&p[images][0]="+encodeURIComponent(n.attr("href")).trim();var p=t("<i/>",{"data-href":"https://www.facebook.com/sharer/sharer.php?s=100"+l,class:"ngg-caption-icon fa fa-facebook-square"}),f=encodeURIComponent(this.get_share_url(i,a,"full"));f+="&url="+o,f+="&media="+n.attr("href"),f+="&description="+d;var h=t("<i/>",{"data-href":"http://pinterest.com/pin/create/button/?s=100"+f,class:"ngg-caption-icon fa fa-pinterest-square"}),u=[g,c,p,h];t(u).each(function(){t(this).on("click",function(e){e.preventDefault();var n=window.open(t(this).data("href"),"_blank");return n.focus(),!1})}),e.html("").append(u)},get_share_url:function(e,n,a){"undefined"==typeof a&&(a="thumb");var i=t.nplModal("get_setting","share_url").replace("{gallery_id}",e).replace("{image_id}",n).replace("{named_size}",a),r=t("<a/>").attr("href",t.nplModal("get_setting","wp_site_url"))[0],o=t("<a/>").attr("href",window.location.toString())[0],s=t("<a/>").attr("href",i)[0];return o.pathname.indexOf(r.pathname)>=0&&(o.pathname=o.pathname.substr(r.pathname.length)),o.pathname.indexOf(s.pathname)>=0&&(o.pathname=o.pathname.substr(o.pathname.length)),s.search=o.search,s.search.length>0&&(s.search+="&"),s.search+="uri="+o.pathname,s.href}},t.fn.nggcaption=function(){this.each(function(){var a=t(this);if(a.data("ngg-captions-processed"))return!0;var r=e(a.data("ngg-captions-id")),o=n(r,"captions_animation","slideup"),d=a.find("img").first();if(!d.attr("src")&&!d.attr("srcset"))return!0;a.data("ngg-captions-processed",1);var g=t('<figure class="ngg-figure"></figure>'),c=t('<figcaption class="ngg-figcaption"></figcaption>'),l=t("<h6>"+i(a.data("title"))+"</h6>");n(r,"captions_display_title",!0)||g.addClass("nggc_no_title");var p=t("<div/>").addClass("nggc-body"),f=t('<p data-ngg-original-description="'+i(a.data("description"))+'"></p>');n(r,"captions_display_title",!0)||f.html(i(a.data("description"))),p.append(f),n(r,"captions_display_description",!0)||g.addClass("nggc_no_description");var h=a.attr("class"),u=a.attr("style"),m=d.attr("style");if(a.removeAttr("title"),a.data("ngg-captions-nostylecopy")||(a.removeAttr("class"),a.removeAttr("style")),g.addClass("ngg-figure-"+o),c.addClass("ngg-figcaption-"+o),t.inArray(r.source,["albums","random","random_images"])==-1&&"undefined"!=typeof window.nplModalSettings&&"1"==nplModalSettings.enable_routing&&"1"==nplModalSettings.enable_sharing&&n(r,"captions_display_sharing",!0)){var _=r.slug;if(!_||_.indexOf("widget-ngg-images")==-1){var y=t('<div class="nggc-icon-wrapper"/>');nggc_share_icons.create(y,a),t(document).trigger("ngg-caption-add-icons",{el:y,image_id:a.data("image-id"),gallery_id:a.data("nplmodal-gallery-id")}),c.append(y)}}else g.addClass("nggc_no_sharing");n(r,"captions_display_title",!0)&&c.append(l),n(r,"captions_display_description",!0)&&c.append(p),t.browser.msie&&(9==t.browser.version&&t(g).addClass("nggc-ie9"),10==t.browser.version&&t(g).addClass("nggc-ie10")),a.data("ngg-captions-nostylecopy")||(g.attr("style",m),g.attr("style",u)),d.removeAttr("style"),a.data("ngg-captions-nostylecopy")||g.css({"max-width":parseInt(d[0].getAttribute("width"))+"px"}),$newfigure=d.wrap(g),d.after(c),a.data("ngg-captions-nostylecopy")||$newfigure.addClass(h),$newfigure.imagesLoaded().done(function(){s(l),s(p)}),$newfigure.parent("p").before($newfigure)}),t(document).trigger("ngg-captions-added")};var s=function(a){"undefined"==typeof a&&(a=t("figcaption.ngg-figcaption h6, figcaption.ngg-figcaption .nggc-body")),a.each(function(){var a=t(this),r=e(a.parents("a").first().data("ngg-captions-id")),o=n(r,"captions_animation","slideup");a.dotdotdot({callback:function(t,e){if("H6"==a.prop("tagName"))if(t&&"titlebar"!=o)t&&"titlebar"!=o&&a.next("div").find("p").text("");else{var n=a.next("div").find("p");n.html(i(n.data("ngg-original-description")))}t&&!a.hasClass("nggc-dotdotdot")&&a.addClass("nggc-dotdotdot"),!t&&a.hasClass("nggc-dotdotdot")&&a.removeClass("nggc-dotdotdot")}})})},d=function(e){e=e||!1,t("a").each(function(){var n=t(this);n.data("ngg-captions-enabled")&&!n.data("ngg-captions-processed")&&(e?t(window).on("load",function(){n.nggcaption()}):n.nggcaption())})};d(!0),t(window).on("refreshed",function(){d(),s()}),t(window).on("resize fullscreenchange mozfullscreenchange webkitfullscreenchange orientationchange",function(){t("figcaption.ngg-figcaption h6, figcaption.ngg-figcaption .nggc-body").each(function(){t(this).trigger("update.dot")})})}}(jQuery);